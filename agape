#!/usr/bin/env python3
import argparse
import sys

def generate_message(name, formal=False):
    """Core logic, separated to be unit-testable."""
    greeting = "Greetings" if formal else "Hello"
    return f"{greeting}, {name}!"

def main(argv=None):
    parser = argparse.ArgumentParser(description="Agape CLI Tool")
    parser.add_argument("name", nargs="?", default="World", help="Name to greet")
    parser.add_argument("--formal", action="store_true", help="Use a formal greeting")

    args = parser.parse_args(argv)

    message = generate_message(args.name, args.formal)
    print(message)
    return 0

if __name__ == "__main__":
    sys.exit(main())